{% extends '@CustomDatabase/sidebar/sidebar.html.twig' %}

{% block content %}
<div class="main-content">
    <div class="data-protection-content">
    <div class="database-header">
        <div class="header-actions">
            <a href="{{ path('home') }}" class="btn-back">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </a>
        </div>
        <h1><i class="fas fa-shield-virus"></i> Advanced Data Protection & Privacy Manager</h1>
        <p>Comprehensive data protection, privacy management, and GDPR compliance tools with advanced security features</p>
    </div>

    {# Top Section: Quick Actions & Stats #}
    <div class="top-section">
        <div class="quick-actions-section">
            <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
            <div class="quick-actions-grid">
                <button class="quick-action-btn" onclick="requestDataAccess()">
                    <i class="fas fa-eye"></i>
                    <span>Request Data Access</span>
                </button>
                <button class="quick-action-btn" onclick="requestDataDeletion()">
                    <i class="fas fa-trash-alt"></i>
                    <span>Delete My Data</span>
                </button>
                <button class="quick-action-btn" onclick="downloadPrivacyReport()">
                    <i class="fas fa-download"></i>
                    <span>Download Report</span>
                </button>
                <button class="quick-action-btn" onclick="exportData()">
                    <i class="fas fa-file-export"></i>
                    <span>Export Data</span>
                </button>
                <button class="quick-action-btn" onclick="manageConsent()">
                    <i class="fas fa-toggle-on"></i>
                    <span>Manage Consent</span>
                </button>
                <button class="quick-action-btn" onclick="viewActivityLog()">
                    <i class="fas fa-history"></i>
                    <span>Activity Log</span>
                </button>
            </div>
        </div>
    </div>

    {# Middle Section: Data Protection Dashboard #}
    <div class="middle-section">
        <div class="data-protection-dashboard">
            <h2><i class="fas fa-chart-line"></i> Data Protection Dashboard</h2>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="card-content">
                        <h3 id="data-points-count">1,250</h3>
                        <p>Data Points Stored</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%"></div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="card-content">
                        <h3 id="security-score">95%</h3>
                        <p>Security Score</p>
                        <div class="progress-bar">
                            <div class="progress-fill security" style="width: 95%"></div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="card-content">
                        <h3 id="compliance-status">Compliant</h3>
                        <p>GDPR Status</p>
                        <div class="status-indicator compliant">
                            <i class="fas fa-check"></i>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="card-content">
                        <h3 id="last-activity">2 days ago</h3>
                        <p>Last Activity</p>
                        <div class="activity-indicator">
                            <i class="fas fa-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# Bottom Section: Advanced Data Protection Tools #}
    <div class="bottom-section">
        <div class="advanced-protection-section">
            <h2><i class="fas fa-cogs"></i> Advanced Data Protection Tools</h2>
            <div class="protection-panel">
                <div class="panel-tabs">
                    <button class="tab-btn active" data-tab="personal-data">Personal Data</button>
                    <button class="tab-btn" data-tab="consent-management">Consent Management</button>
                    <button class="tab-btn" data-tab="data-rights">Data Rights</button>
                    <button class="tab-btn" data-tab="security-settings">Security Settings</button>
                    <button class="tab-btn" data-tab="audit-logs">Audit Logs</button>
                    <button class="tab-btn" data-tab="compliance">Compliance</button>
                    <button class="tab-btn" data-tab="reports">Reports</button>
                    <button class="tab-btn" data-tab="settings">Settings</button>
                </div>

                <div class="tab-content">
                    <!-- Personal Data Tab -->
                    <div id="personal-data-tab" class="tab-pane active" style="display: block;">
                        <div class="personal-data-grid">
                            <div class="data-category-card">
                                <h3><i class="fas fa-id-card"></i> Personal Information</h3>
                                <div class="data-items">
                                    <div class="data-item">
                                        <div class="data-label">Full Name</div>
                                        <div class="data-value">John Doe</div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="editData('name')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                    <div class="data-item">
                                        <div class="data-label">Email Address</div>
                                        <div class="data-value">john.doe@example.com</div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="editData('email')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                    <div class="data-item">
                                        <div class="data-label">Phone Number</div>
                                        <div class="data-value">+1 (555) 123-4567</div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="editData('phone')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="data-category-card">
                                <h3><i class="fas fa-history"></i> Activity Data</h3>
                                <div class="activity-timeline">
                                    <div class="timeline-item">
                                        <div class="timeline-icon">
                                            <i class="fas fa-sign-in-alt"></i>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">Logged in</div>
                                            <div class="timeline-time">2 days ago</div>
                                            <div class="timeline-location">New York, US</div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-icon">
                                            <i class="fas fa-file-download"></i>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">Downloaded report</div>
                                            <div class="timeline-time">1 week ago</div>
                                            <div class="timeline-location">New York, US</div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-icon">
                                            <i class="fas fa-cog"></i>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">Updated privacy settings</div>
                                            <div class="timeline-time">2 weeks ago</div>
                                            <div class="timeline-location">New York, US</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Consent Management Tab -->
                    <div id="consent-management-tab" class="tab-pane">
                        <div class="consent-management-grid">
                            <div class="consent-category">
                                <h3><i class="fas fa-cookie-bite"></i> Cookie Preferences</h3>
                                <div class="consent-items">
                                    <div class="consent-item">
                                        <div class="consent-header">
                                            <div class="consent-title">Essential Cookies</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked disabled>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="consent-description">
                                            Required for basic website functionality. Cannot be disabled.
                                        </div>
                                    </div>
                                    <div class="consent-item">
                                        <div class="consent-header">
                                            <div class="consent-title">Analytics Cookies</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="analytics-consent" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="consent-description">
                                            Help us understand how you use our service to improve your experience.
                                        </div>
                                    </div>
                                    <div class="consent-item">
                                        <div class="consent-header">
                                            <div class="consent-title">Marketing Cookies</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="marketing-consent">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="consent-description">
                                            Used to deliver personalized advertisements and marketing content.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="consent-category">
                                <h3><i class="fas fa-share-alt"></i> Data Sharing Preferences</h3>
                                <div class="consent-items">
                                    <div class="consent-item">
                                        <div class="consent-header">
                                            <div class="consent-title">Third-party Sharing</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="third-party-consent">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="consent-description">
                                            Allow sharing of anonymized data with trusted third-party partners.
                                        </div>
                                    </div>
                                    <div class="consent-item">
                                        <div class="consent-header">
                                            <div class="consent-title">Profiling & Personalization</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="profiling-consent" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="consent-description">
                                            Enable personalized recommendations and content based on your usage patterns.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="consent-actions">
                                <button class="btn btn-primary" onclick="saveConsentSettings()">
                                    <i class="fas fa-save"></i> Save Preferences
                                </button>
                                <button class="btn btn-outline-secondary" onclick="resetConsentSettings()">
                                    <i class="fas fa-undo"></i> Reset to Defaults
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Data Rights Tab -->
                    <div id="data-rights-tab" class="tab-pane">
                        <div class="data-rights-grid">
                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Access</h4>
                                    <p>Request a copy of all personal data we hold about you.</p>
                                    <button class="btn btn-outline-primary" onclick="requestDataAccess()">
                                        Request Access
                                    </button>
                                </div>
                            </div>

                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-edit"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Rectification</h4>
                                    <p>Request correction of inaccurate or incomplete personal data.</p>
                                    <button class="btn btn-outline-primary" onclick="requestDataRectification()">
                                        Request Correction
                                    </button>
                                </div>
                            </div>

                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-trash-alt"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Erasure</h4>
                                    <p>Request deletion of your personal data ("Right to be forgotten").</p>
                                    <button class="btn btn-outline-danger" onclick="requestDataDeletion()">
                                        Request Deletion
                                    </button>
                                </div>
                            </div>

                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-ban"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Restriction</h4>
                                    <p>Request limitation of how we process your personal data.</p>
                                    <button class="btn btn-outline-primary" onclick="requestDataRestriction()">
                                        Request Restriction
                                    </button>
                                </div>
                            </div>

                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-exchange-alt"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Portability</h4>
                                    <p>Request your data in a structured, machine-readable format.</p>
                                    <button class="btn btn-outline-primary" onclick="requestDataPortability()">
                                        Request Portability
                                    </button>
                                </div>
                            </div>

                            <div class="right-card">
                                <div class="right-icon">
                                    <i class="fas fa-gavel"></i>
                                </div>
                                <div class="right-content">
                                    <h4>Right to Object</h4>
                                    <p>Object to processing of your personal data for certain purposes.</p>
                                    <button class="btn btn-outline-primary" onclick="objectToProcessing()">
                                        Object to Processing
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Data Deletion Modal -->
                        <div id="deletion-modal" class="modal" style="display: none;">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h3>Confirm Data Deletion</h3>
                                    <span class="modal-close" onclick="closeDeletionModal()">&times;</span>
                                </div>
                                <div class="modal-body">
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <strong>Warning:</strong> This action cannot be undone. All your personal data will be permanently deleted.
                                    </div>
                                    <p>To confirm deletion, please type <strong>"DELETE_MY_DATA"</strong> in the field below:</p>
                                    <input type="text" id="deletion-confirmation" class="form-control" placeholder="Type DELETE_MY_DATA to confirm">
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" onclick="closeDeletionModal()">Cancel</button>
                                    <button class="btn btn-danger" onclick="confirmDataDeletion()">Delete My Data</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings Tab -->
                    <div id="security-settings-tab" class="tab-pane">
                        <div class="security-settings-grid">
                            <div class="security-section">
                                <h3><i class="fas fa-key"></i> Password & Authentication</h3>
                                <div class="security-items">
                                    <div class="security-item">
                                        <div class="security-info">
                                            <div class="security-title">Password Strength</div>
                                            <div class="security-status">
                                                <div class="strength-indicator">
                                                    <div class="strength-bar" style="width: 80%"></div>
                                                </div>
                                                <span class="strength-text">Strong</span>
                                            </div>
                                        </div>
                                        <button class="btn btn-sm btn-outline-primary" onclick="changePassword()">
                                            Change Password
                                        </button>
                                    </div>

                                    <div class="security-item">
                                        <div class="security-info">
                                            <div class="security-title">Two-Factor Authentication</div>
                                            <div class="security-status">
                                                <span class="status-badge enabled">Enabled</span>
                                            </div>
                                        </div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="manage2FA()">
                                            Manage 2FA
                                        </button>
                                    </div>

                                    <div class="security-item">
                                        <div class="security-info">
                                            <div class="security-title">Login Sessions</div>
                                            <div class="security-status">
                                                <span class="status-text">2 active sessions</span>
                                            </div>
                                        </div>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="viewSessions()">
                                            View Sessions
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="security-section">
                                <h3><i class="fas fa-shield-alt"></i> Security Features</h3>
                                <div class="security-features">
                                    <div class="feature-item">
                                        <div class="feature-icon">
                                            <i class="fas fa-lock"></i>
                                        </div>
                                        <div class="feature-content">
                                            <h4>Data Encryption</h4>
                                            <p>All data is encrypted using AES-256 encryption both in transit and at rest.</p>
                                        </div>
                                    </div>

                                    <div class="feature-item">
                                        <div class="feature-icon">
                                            <i class="fas fa-eye"></i>
                                        </div>
                                        <div class="feature-content">
                                            <h4>Security Monitoring</h4>
                                            <p>24/7 monitoring for suspicious activities and security threats.</p>
                                        </div>
                                    </div>

                                    <div class="feature-item">
                                        <div class="feature-icon">
                                            <i class="fas fa-user-shield"></i>
                                        </div>
                                        <div class="feature-content">
                                            <h4>Access Controls</h4>
                                            <p>Role-based access control ensures only authorized personnel can access your data.</p>
                                        </div>
                                    </div>

                                    <div class="feature-item">
                                        <div class="feature-icon">
                                            <i class="fas fa-file-contract"></i>
                                        </div>
                                        <div class="feature-content">
                                            <h4>Compliance</h4>
                                            <p>Fully compliant with GDPR, CCPA, and other privacy regulations.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audit Logs Tab -->
                    <div id="audit-logs-tab" class="tab-pane">
                        <div class="audit-logs-section">
                            <h3><i class="fas fa-clipboard-list"></i> Data Access Audit Logs</h3>
                            <div class="audit-filters">
                                <div class="filter-group">
                                    <label for="audit-date-range">Date Range</label>
                                    <select id="audit-date-range">
                                        <option value="7">Last 7 days</option>
                                        <option value="30">Last 30 days</option>
                                        <option value="90">Last 90 days</option>
                                        <option value="365">Last year</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="audit-action">Action Type</label>
                                    <select id="audit-action">
                                        <option value="all">All Actions</option>
                                        <option value="access">Data Access</option>
                                        <option value="modify">Data Modification</option>
                                        <option value="delete">Data Deletion</option>
                                        <option value="export">Data Export</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="filterAuditLogs()">
                                    <i class="fas fa-filter"></i> Apply Filters
                                </button>
                            </div>

                            <div class="audit-table-container">
                                <table class="audit-table">
                                    <thead>
                                        <tr>
                                            <th>Date & Time</th>
                                            <th>Action</th>
                                            <th>Data Type</th>
                                            <th>IP Address</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="audit-table-body">
                                        <tr>
                                            <td>2024-01-15 14:30:25</td>
                                            <td>Data Access Request</td>
                                            <td>Personal Information</td>
                                            <td>192.168.1.100</td>
                                            <td><span class="status-badge success">Completed</span></td>
                                        </tr>
                                        <tr>
                                            <td>2024-01-10 09:15:42</td>
                                            <td>Data Export</td>
                                            <td>Usage Data</td>
                                            <td>192.168.1.100</td>
                                            <td><span class="status-badge success">Completed</span></td>
                                        </tr>
                                        <tr>
                                            <td>2024-01-05 16:22:18</td>
                                            <td>Consent Update</td>
                                            <td>Privacy Settings</td>
                                            <td>192.168.1.100</td>
                                            <td><span class="status-badge success">Completed</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Compliance Tab -->
                    <div id="compliance-tab" class="tab-pane">
                        <div class="compliance-section">
                            <h3><i class="fas fa-check-circle"></i> Compliance Status</h3>
                            <div class="compliance-grid">
                                <div class="compliance-card gdpr">
                                    <div class="compliance-header">
                                        <div class="compliance-icon">
                                            <i class="fas fa-european-union"></i>
                                        </div>
                                        <div class="compliance-title">
                                            <h4>GDPR Compliance</h4>
                                            <span class="compliance-status compliant">Compliant</span>
                                        </div>
                                    </div>
                                    <div class="compliance-details">
                                        <p>General Data Protection Regulation (EU)</p>
                                        <div class="compliance-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: 98%"></div>
                                            </div>
                                            <span class="progress-text">98% Compliant</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="compliance-card ccpa">
                                    <div class="compliance-header">
                                        <div class="compliance-icon">
                                            <i class="fas fa-flag-usa"></i>
                                        </div>
                                        <div class="compliance-title">
                                            <h4>CCPA Compliance</h4>
                                            <span class="compliance-status compliant">Compliant</span>
                                        </div>
                                    </div>
                                    <div class="compliance-details">
                                        <p>California Consumer Privacy Act (US)</p>
                                        <div class="compliance-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: 96%"></div>
                                            </div>
                                            <span class="progress-text">96% Compliant</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="compliance-card pipeda">
                                    <div class="compliance-header">
                                        <div class="compliance-icon">
                                            <i class="fas fa-canadian-maple-leaf"></i>
                                        </div>
                                        <div class="compliance-title">
                                            <h4>PIPEDA Compliance</h4>
                                            <span class="compliance-status compliant">Compliant</span>
                                        </div>
                                    </div>
                                    <div class="compliance-details">
                                        <p>Personal Information Protection and Electronic Documents Act (Canada)</p>
                                        <div class="compliance-progress">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: 95%"></div>
                                            </div>
                                            <span class="progress-text">95% Compliant</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reports Tab -->
                    <div id="reports-tab" class="tab-pane">
                        <div class="reports-section">
                            <h3><i class="fas fa-chart-bar"></i> Privacy Reports</h3>
                            <div class="reports-grid">
                                <div class="report-card">
                                    <div class="report-icon">
                                        <i class="fas fa-file-pdf"></i>
                                    </div>
                                    <div class="report-content">
                                        <h4>Data Processing Report</h4>
                                        <p>Comprehensive report of all data processing activities</p>
                                        <button class="btn btn-outline-primary" onclick="generateProcessingReport()">
                                            Generate Report
                                        </button>
                                    </div>
                                </div>

                                <div class="report-card">
                                    <div class="report-icon">
                                        <i class="fas fa-file-excel"></i>
                                    </div>
                                    <div class="report-content">
                                        <h4>Data Inventory Report</h4>
                                        <p>Detailed inventory of all personal data collected</p>
                                        <button class="btn btn-outline-primary" onclick="generateInventoryReport()">
                                            Generate Report
                                        </button>
                                    </div>
                                </div>

                                <div class="report-card">
                                    <div class="report-icon">
                                        <i class="fas fa-file-contract"></i>
                                    </div>
                                    <div class="report-content">
                                        <h4>Consent Report</h4>
                                        <p>Report on user consent and preferences</p>
                                        <button class="btn btn-outline-primary" onclick="generateConsentReport()">
                                            Generate Report
                                        </button>
                                    </div>
                                </div>

                                <div class="report-card">
                                    <div class="report-icon">
                                        <i class="fas fa-shield-alt"></i>
                                    </div>
                                    <div class="report-content">
                                        <h4>Security Assessment</h4>
                                        <p>Assessment of data security measures</p>
                                        <button class="btn btn-outline-primary" onclick="generateSecurityReport()">
                                            Generate Report
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div id="settings-tab" class="tab-pane">
                        <div class="settings-section">
                            <h3><i class="fas fa-cog"></i> Privacy Settings</h3>
                            <div class="settings-grid">
                                <div class="setting-group">
                                    <h4>Notification Preferences</h4>
                                    <div class="setting-items">
                                        <div class="setting-item">
                                            <div class="setting-label">Data processing notifications</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="processing-notifications" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="setting-item">
                                            <div class="setting-label">Security alerts</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="security-alerts" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="setting-item">
                                            <div class="setting-label">Privacy policy updates</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="policy-updates" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="setting-group">
                                    <h4>Data Retention</h4>
                                    <div class="setting-items">
                                        <div class="setting-item">
                                            <div class="setting-label">Automatically delete inactive data</div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="auto-delete" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="setting-item">
                                            <div class="setting-label">Data retention period</div>
                                            <select id="retention-period">
                                                <option value="1">1 year</option>
                                                <option value="2" selected>2 years</option>
                                                <option value="3">3 years</option>
                                                <option value="5">5 years</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="setting-actions">
                                    <button class="btn btn-primary" onclick="savePrivacySettings()">
                                        <i class="fas fa-save"></i> Save Settings
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="resetPrivacySettings()">
                                        <i class="fas fa-undo"></i> Reset to Defaults
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

<style>
:root {
    --pimcore-blue: #2D6DB4;
    --pimcore-light-blue: #4A90E2;
    --pimcore-dark-blue: #1A365D;
    --success-color: #2ecc71;
    --warning-color: #f39c12;
    --danger-color: #e74c3c;
    --light-color: #f8f9fa;
    --dark-color: #2c3e50;
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --glass-bg: rgba(255, 255, 255, 0.95);
    --glass-border: rgba(255, 255, 255, 0.2);
}

.data-protection-content {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    padding: 20px 0;
}

/* Three-Section Layout */
.top-section {
    margin-bottom: 40px;
    padding: 0 20px;
}

.middle-section {
    margin-bottom: 40px;
    padding: 0 20px;
}

.bottom-section {
    margin-bottom: 40px;
    padding: 0 20px;
}

.quick-actions-section {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 20px;
}

.quick-actions-section h2 {
    font-size: 24px;
    font-weight: 700;
    color: var(--dark-color);
    margin-bottom: 25px;
    text-align: center;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.quick-actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.quick-action-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    padding: 20px;
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.quick-action-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.quick-action-btn i {
    font-size: 24px;
    margin-bottom: 5px;
}

.data-protection-dashboard {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 20px;
}

.data-protection-dashboard h2 {
    font-size: 24px;
    font-weight: 700;
    color: var(--dark-color);
    margin-bottom: 25px;
    text-align: center;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.dashboard-card {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    display: flex;
    align-items: center;
    gap: 20px;
    border: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

.dashboard-card:hover {
    transform: translateY(-3px);
}

.card-icon {
    font-size: 36px;
    color: var(--primary-color);
    min-width: 60px;
}

.card-content h3 {
    margin: 0 0 5px 0;
    font-size: 28px;
    font-weight: 700;
    color: var(--dark-color);
}

.card-content p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

.progress-bar {
    width: 100%;
    height: 6px;
    background: #e9ecef;
    border-radius: 3px;
    margin-top: 10px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary-gradient);
    border-radius: 3px;
    transition: width 0.3s ease;
}

.progress-fill.security {
    background: linear-gradient(90deg, #27ae60, #2ecc71);
}

.status-indicator {
    margin-top: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: var(--success-color);
    color: white;
}

.activity-indicator {
    margin-top: 10px;
    text-align: center;
}

.activity-indicator i {
    color: #27ae60;
    font-size: 20px;
}

.advanced-protection-section {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 20px;
}

.advanced-protection-section h2 {
    font-size: 24px;
    font-weight: 700;
    color: var(--dark-color);
    margin-bottom: 25px;
    text-align: center;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.protection-panel {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.panel-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    border-bottom: 1px solid #e2e8f0;
    padding-bottom: 20px;
    flex-wrap: wrap;
}

.tab-btn {
    padding: 12px 20px;
    border: none;
    background: transparent;
    color: #666;
    font-weight: 500;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    position: relative;
}

.tab-btn.active, .tab-btn:hover {
    background: var(--primary-gradient);
    color: white;
}

.tab-pane {
    display: none;
}

.tab-pane.active {
    display: block;
}

.personal-data-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
}

.data-category-card {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.data-category-card h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.data-items {
    display: grid;
    gap: 15px;
}

.data-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.data-label {
    font-weight: 600;
    color: #666;
}

.data-value {
    font-weight: 600;
    color: var(--dark-color);
}

.activity-timeline {
    display: grid;
    gap: 20px;
}

.timeline-item {
    display: flex;
    align-items: flex-start;
    gap: 15px;
}

.timeline-icon {
    width: 40px;
    height: 40px;
    background: var(--primary-gradient);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.timeline-content {
    flex: 1;
}

.timeline-title {
    font-weight: 600;
    color: var(--dark-color);
    margin-bottom: 5px;
}

.timeline-time {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 2px;
}

.timeline-location {
    font-size: 0.8rem;
    color: #999;
}

.consent-management-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
}

.consent-category {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.consent-category h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.consent-items {
    display: grid;
    gap: 20px;
}

.consent-item {
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
}

.consent-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.consent-title {
    font-weight: 600;
    color: var(--dark-color);
}

.consent-description {
    color: #666;
    font-size: 0.9rem;
}

.consent-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 30px;
}

.data-rights-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.right-card {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 10px;
    text-align: center;
    transition: transform 0.3s ease;
}

.right-card:hover {
    transform: translateY(-3px);
}

.right-icon {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 15px;
}

.right-content h4 {
    margin: 0 0 10px 0;
    color: var(--dark-color);
    font-size: 1.1rem;
}

.right-content p {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 15px;
}

.security-settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
}

.security-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.security-section h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.security-items {
    display: grid;
    gap: 15px;
}

.security-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
}

.security-info {
    flex: 1;
}

.security-title {
    font-weight: 600;
    color: var(--dark-color);
    margin-bottom: 5px;
}

.security-status {
    display: flex;
    align-items: center;
    gap: 10px;
}

.strength-indicator {
    flex: 1;
    height: 6px;
    background: #e9ecef;
    border-radius: 3px;
    overflow: hidden;
}

.strength-bar {
    height: 100%;
    background: var(--primary-gradient);
    border-radius: 3px;
}

.strength-text {
    font-size: 0.8rem;
    color: #666;
    font-weight: 500;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

.status-badge.enabled {
    background: #d4edda;
    color: #155724;
}

.status-text {
    font-size: 0.9rem;
    color: #666;
}

.security-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.feature-item {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
}

.feature-icon {
    font-size: 2rem;
    color: var(--primary-color);
    margin-top: 5px;
}

.feature-content h4 {
    margin: 0 0 10px 0;
    color: var(--dark-color);
    font-size: 1.1rem;
}

.feature-content p {
    margin: 0;
    color: #666;
    font-size: 0.9rem;
}

.audit-logs-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.audit-logs-section h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.audit-filters {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.filter-group label {
    font-weight: 600;
    color: var(--dark-color);
    font-size: 14px;
}

.filter-group select {
    padding: 8px 12px;
    border: 2px solid #e2e8f0;
    border-radius: 6px;
    font-size: 14px;
}

.audit-table-container {
    overflow-x: auto;
}

.audit-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.audit-table th {
    background: var(--primary-gradient);
    color: white;
    padding: 15px;
    text-align: left;
    font-weight: 600;
}

.audit-table td {
    padding: 15px;
    border-bottom: 1px solid #e9ecef;
}

.audit-table tr:last-child td {
    border-bottom: none;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

.status-badge.success {
    background: #d4edda;
    color: #155724;
}

.compliance-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.compliance-section h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.compliance-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
}

.compliance-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

.compliance-card:hover {
    transform: translateY(-3px);
}

.compliance-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

.compliance-icon {
    font-size: 2.5rem;
    color: var(--primary-color);
}

.compliance-title h4 {
    margin: 0 0 5px 0;
    color: var(--dark-color);
    font-size: 1.1rem;
}

.compliance-status {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
    background: #d4edda;
    color: #155724;
}

.compliance-status.compliant {
    background: #d4edda;
    color: #155724;
}

.compliance-details p {
    margin: 0 0 15px 0;
    color: #666;
    font-size: 0.9rem;
}

.compliance-progress {
    display: flex;
    align-items: center;
    gap: 10px;
}

.compliance-progress .progress-bar {
    flex: 1;
    height: 8px;
    background: #e9ecef;
    border-radius: 4px;
    overflow: hidden;
}

.compliance-progress .progress-fill {
    height: 100%;
    background: var(--primary-gradient);
    border-radius: 4px;
    transition: width 0.3s ease;
}

.progress-text {
    font-size: 0.8rem;
    color: #666;
    font-weight: 500;
    min-width: 60px;
}

.reports-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.reports-section h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.reports-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.report-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 12px;
    padding: 25px;
    display: flex;
    align-items: flex-start;
    gap: 20px;
    border: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

.report-card:hover {
    transform: translateY(-3px);
}

.report-icon {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-top: 5px;
}

.report-content h4 {
    margin: 0 0 10px 0;
    color: var(--dark-color);
    font-size: 1.1rem;
}

.report-content p {
    margin: 0 0 15px 0;
    color: #666;
    font-size: 0.9rem;
}

.settings-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 25px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.settings-section h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--dark-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
}

.setting-group {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 10px;
    padding: 20px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.setting-group h4 {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--dark-color);
}

.setting-items {
    display: grid;
    gap: 15px;
}

.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.setting-label {
    font-weight: 500;
    color: var(--dark-color);
}

.setting-item select {
    padding: 6px 10px;
    border: 2px solid #e2e8f0;
    border-radius: 6px;
    font-size: 14px;
}

.setting-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 30px;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    background-color: white;
    margin: 15% auto;
    padding: 0;
    border: 1px solid #888;
    width: 90%;
    max-width: 500px;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.modal-header {
    padding: 20px 30px;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    margin: 0;
    color: var(--dark-color);
}

.modal-close {
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal-close:hover {
    color: #666;
}

.modal-body {
    padding: 30px;
}

.modal-footer {
    padding: 20px 30px;
    border-top: 1px solid #e9ecef;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

/* Toggle Switch Styles */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.4s;
    border-radius: 24px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: 0.4s;
    border-radius: 50%;
}

input:checked + .toggle-slider {
    background-color: var(--primary-color);
}

input:checked + .toggle-slider:before {
    transform: translateX(26px);
}

/* Button Styles */
.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    text-decoration: none;
}

.btn-primary {
    background: var(--primary-gradient);
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.btn-outline-primary {
    background: transparent;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
}

.btn-outline-primary:hover {
    background: var(--primary-color);
    color: white;
}

.btn-outline-secondary {
    background: transparent;
    color: #666;
    border: 2px solid #e2e8f0;
}

.btn-outline-secondary:hover {
    background: #e2e8f0;
    color: var(--dark-color);
}

.btn-outline-danger {
    background: transparent;
    color: var(--danger-color);
    border: 2px solid var(--danger-color);
}

.btn-outline-danger:hover {
    background: var(--danger-color);
    color: white;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

/* Form Styles */
.form-control {
    width: 100%;
    padding: 10px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.form-control:focus {
    border-color: var(--primary-color);
    outline: none;
}

/* Alert Styles */
.alert {
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.alert-warning {
    background: linear-gradient(135deg, #fff3cd, #ffeaa7);
    color: #856404;
    border: 1px solid #ffeaa7;
}

/* Responsive Design */
@media (max-width: 768px) {
    .data-protection-content {
        padding: 10px 0;
    }

    .top-section,
    .middle-section,
    .bottom-section {
        padding: 0 10px;
        margin-bottom: 30px;
    }

    .quick-actions-section,
    .data-protection-dashboard,
    .advanced-protection-section {
        padding: 20px;
    }

    .quick-actions-section h2,
    .data-protection-dashboard h2,
    .advanced-protection-section h2 {
        font-size: 20px;
        margin-bottom: 20px;
    }

    .quick-actions-grid {
        grid-template-columns: 1fr;
    }

    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .personal-data-grid,
    .consent-management-grid,
    .security-settings-grid {
        grid-template-columns: 1fr;
    }

    .data-rights-grid {
        grid-template-columns: 1fr;
    }

    .compliance-grid {
        grid-template-columns: 1fr;
    }

    .reports-grid {
        grid-template-columns: 1fr;
    }

    .settings-grid {
        grid-template-columns: 1fr;
    }

    .panel-tabs {
        flex-wrap: wrap;
    }

    .tab-btn {
        flex: 1;
        min-width: 120px;
    }

    .audit-filters {
        flex-direction: column;
        gap: 15px;
    }

    .modal-content {
        width: 95%;
        margin: 20% auto;
    }

    .modal-header,
    .modal-body,
    .modal-footer {
        padding: 20px;
    }
}

@media (max-width: 480px) {
    .data-protection-content {
        padding: 5px 0;
    }

    .top-section,
    .middle-section,
    .bottom-section {
        padding: 0 5px;
        margin-bottom: 20px;
    }

    .quick-actions-section,
    .data-protection-dashboard,
    .advanced-protection-section {
        padding: 15px;
        border-radius: 10px;
    }

    .quick-actions-section h2,
    .data-protection-dashboard h2,
    .advanced-protection-section h2 {
        font-size: 18px;
        margin-bottom: 15px;
    }

    .quick-action-btn {
        padding: 15px 10px;
        font-size: 13px;
    }

    .dashboard-card {
        padding: 20px;
        gap: 15px;
    }

    .card-content h3 {
        font-size: 24px;
    }

    .right-card,
    .report-card {
        padding: 20px;
    }

    .modal-content {
        width: 98%;
        margin: 10% auto;
    }
}
</style>

<script>
$(document).ready(function() {
    // Tab switching functionality
    $('.tab-btn').click(function() {
        const tabId = $(this).data('tab');

        // Update tab buttons
        $('.tab-btn').removeClass('active');
        $(this).addClass('active');

        // Update tab content
        $('.tab-pane').removeClass('active').hide();
        $('#' + tabId + '-tab').addClass('active').show();
    });

    // Toggle switches
    $('.toggle-switch input').change(function() {
        const isChecked = $(this).is(':checked');
        const toggleSlider = $(this).next('.toggle-slider');

        if (isChecked) {
            toggleSlider.addClass('checked');
        } else {
            toggleSlider.removeClass('checked');
        }
    });

    // Quick action buttons
    $('.quick-action-btn').click(function() {
        const action = $(this).find('span').text().toLowerCase().replace(/\s+/g, '');

        switch(action) {
            case 'requestdataaccess':
                requestDataAccess();
                break;
            case 'deletemydata':
                requestDataDeletion();
                break;
            case 'downloadreport':
                downloadPrivacyReport();
                break;
            case 'exportdata':
                exportData();
                break;
            case 'manageconsent':
                manageConsent();
                break;
            case 'activitylog':
                viewActivityLog();
                break;
        }
    });
});

// Quick Actions Functions
function requestDataAccess() {
    showNotification('Data access request submitted successfully. You will receive a response within 30 days.', 'success');
}

function requestDataDeletion() {
    $('#deletion-modal').show();
}

function closeDeletionModal() {
    $('#deletion-modal').hide();
}

function confirmDataDeletion() {
    const confirmation = $('#deletion-confirmation').val();
    if (confirmation === 'DELETE_MY_DATA') {
        showNotification('Data deletion request submitted. Your data will be permanently deleted within 30 days.', 'success');
        $('#deletion-modal').hide();
    } else {
        showNotification('Please type "DELETE_MY_DATA" to confirm deletion.', 'error');
    }
}

function downloadPrivacyReport() {
    showNotification('Generating privacy report...', 'info');
    setTimeout(() => {
        showNotification('Privacy report downloaded successfully!', 'success');
    }, 2000);
}

function exportData() {
    showNotification('Preparing data export...', 'info');
    setTimeout(() => {
        showNotification('Data export completed! Check your downloads.', 'success');
    }, 3000);
}

function manageConsent() {
    // Switch to consent management tab
    $('.tab-btn').removeClass('active');
    $('.tab-btn[data-tab="consent-management"]').addClass('active');

    $('.tab-pane').removeClass('active').hide();
    $('#consent-management-tab').addClass('active').show();

    showNotification('Consent management section opened.', 'info');
}

function viewActivityLog() {
    // Switch to audit logs tab
    $('.tab-btn').removeClass('active');
    $('.tab-btn[data-tab="audit-logs"]').addClass('active');

    $('.tab-pane').removeClass('active').hide();
    $('#audit-logs-tab').addClass('active').show();

    showNotification('Activity log section opened.', 'info');
}

// Data Rights Functions
function requestDataRectification() {
    showNotification('Data rectification request submitted. You will be contacted for verification.', 'success');
}

function requestDataRestriction() {
    showNotification('Data processing restriction request submitted.', 'success');
}

function requestDataPortability() {
    showNotification('Data portability request submitted. You will receive your data within 30 days.', 'success');
}

function objectToProcessing() {
    showNotification('Objection to data processing submitted.', 'success');
}

// Security Functions
function changePassword() {
    showNotification('Password change functionality would open here.', 'info');
}

function manage2FA() {
    showNotification('Two-factor authentication management would open here.', 'info');
}

function viewSessions() {
    showNotification('Active sessions management would open here.', 'info');
}

// Consent Functions
function saveConsentSettings() {
    const analyticsConsent = $('#analytics-consent').is(':checked');
    const marketingConsent = $('#marketing-consent').is(':checked');
    const profilingConsent = $('#profiling-consent').is(':checked');
    const thirdPartyConsent = $('#third-party-consent').is(':checked');

    // Save consent settings (in real app, this would be sent to server)
    const consentSettings = {
        analytics: analyticsConsent,
        marketing: marketingConsent,
        profiling: profilingConsent,
        thirdParty: thirdPartyConsent
    };

    localStorage.setItem('consentSettings', JSON.stringify(consentSettings));
    showNotification('Consent settings saved successfully!', 'success');
}

function resetConsentSettings() {
    $('#analytics-consent').prop('checked', false);
    $('#marketing-consent').prop('checked', false);
    $('#profiling-consent').prop('checked', true);
    $('#third-party-consent').prop('checked', false);
    showNotification('Consent settings reset to defaults.', 'info');
}

// Audit Functions
function filterAuditLogs() {
    const dateRange = $('#audit-date-range').val();
    const actionType = $('#audit-action').val();

    showNotification(`Filtering audit logs: ${dateRange}, ${actionType}`, 'info');

    // In real app, this would filter the audit logs from server
    setTimeout(() => {
        showNotification('Audit logs filtered successfully.', 'success');
    }, 1000);
}

// Report Functions
function generateProcessingReport() {
    showNotification('Generating data processing report...', 'info');
    setTimeout(() => {
        showNotification('Data processing report generated and downloaded!', 'success');
    }, 2000);
}

function generateInventoryReport() {
    showNotification('Generating data inventory report...', 'info');
    setTimeout(() => {
        showNotification('Data inventory report generated and downloaded!', 'success');
    }, 2000);
}

function generateConsentReport() {
    showNotification('Generating consent report...', 'info');
    setTimeout(() => {
        showNotification('Consent report generated and downloaded!', 'success');
    }, 2000);
}

function generateSecurityReport() {
    showNotification('Generating security assessment report...', 'info');
    setTimeout(() => {
        showNotification('Security assessment report generated and downloaded!', 'success');
    }, 2000);
}

// Settings Functions
function savePrivacySettings() {
    const processingNotifications = $('#processing-notifications').is(':checked');
    const securityAlerts = $('#security-alerts').is(':checked');
    const policyUpdates = $('#policy-updates').is(':checked');
    const autoDelete = $('#auto-delete').is(':checked');
    const retentionPeriod = $('#retention-period').val();

    const settings = {
        notifications: {
            processing: processingNotifications,
            security: securityAlerts,
            policy: policyUpdates
        },
        retention: {
            autoDelete: autoDelete,
            period: retentionPeriod
        }
    };

    localStorage.setItem('privacySettings', JSON.stringify(settings));
    showNotification('Privacy settings saved successfully!', 'success');
}

function resetPrivacySettings() {
    $('#processing-notifications').prop('checked', true);
    $('#security-alerts').prop('checked', true);
    $('#policy-updates').prop('checked', true);
    $('#auto-delete').prop('checked', true);
    $('#retention-period').val('2');
    showNotification('Privacy settings reset to defaults.', 'info');
}

// Data Edit Functions
function editData(field) {
    const currentValue = $(`.data-item:contains("${field === 'name' ? 'Full Name' : field === 'email' ? 'Email Address' : 'Phone Number'}") .data-value`).text();
    const newValue = prompt(`Enter new ${field}:`, currentValue);

    if (newValue && newValue !== currentValue) {
        // Update the display
        $(`.data-item:contains("${field === 'name' ? 'Full Name' : field === 'email' ? 'Email Address' : 'Phone Number'}") .data-value`).text(newValue);
        showNotification(`${field.charAt(0).toUpperCase() + field.slice(1)} updated successfully!`, 'success');
    }
}

// Notification System
function showNotification(message, type = 'info') {
    // Remove existing notifications
    $('.notification').remove();

    // Create notification element
    const notification = $(`
        <div class="notification ${type}" style="display: none;">
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
            ${message}
        </div>
    `);

    // Add to page
    $('body').append(notification);

    // Show notification
    notification.fadeIn(300);

    // Auto-hide after 5 seconds
    setTimeout(() => {
        notification.fadeOut(300, function() {
            $(this).remove();
        });
    }, 5000);
}

// Initialize on page load
$(document).ready(function() {
    // Load saved consent settings
    const savedConsent = localStorage.getItem('consentSettings');
    if (savedConsent) {
        const consentSettings = JSON.parse(savedConsent);
        $('#analytics-consent').prop('checked', consentSettings.analytics);
        $('#marketing-consent').prop('checked', consentSettings.marketing);
        $('#profiling-consent').prop('checked', consentSettings.profiling);
        $('#third-party-consent').prop('checked', consentSettings.thirdParty);
    }

    // Load saved privacy settings
    const savedSettings = localStorage.getItem('privacySettings');
    if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        $('#processing-notifications').prop('checked', settings.notifications.processing);
        $('#security-alerts').prop('checked', settings.notifications.security);
        $('#policy-updates').prop('checked', settings.notifications.policy);
        $('#auto-delete').prop('checked', settings.retention.autoDelete);
        $('#retention-period').val(settings.retention.period);
    }

    // Initialize toggle switches
    $('.toggle-switch input:checked').each(function() {
        $(this).next('.toggle-slider').addClass('checked');
    });
});
</script>
{% endblock %}